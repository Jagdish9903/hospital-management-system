<div class="my-appointments-container">
  <!-- Header -->
  <div class="page-header">
    <div class="header-content">
      <h1 class="page-title">My Appointments</h1>
      <p class="page-subtitle">Manage your upcoming and past appointments</p>
    </div>
    <div class="header-actions">
      <button class="btn btn-primary" (click)="router.navigate(['/schedule-appointment'])">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M12 5v14m-7-7h14"/>
        </svg>
        Schedule New Appointment
      </button>
    </div>
  </div>

  <!-- Loading State -->
  <div *ngIf="isLoading" class="loading-container">
    <div class="loading-spinner"></div>
    <p>Loading your appointments...</p>
  </div>

  <!-- Appointments Content -->
  <div *ngIf="!isLoading" class="appointments-content">
    <!-- Tabs -->
    <div class="tabs-container">
      <div class="tabs">
        <button 
          class="tab-button" 
          [class.active]="activeTab === 'upcoming'"
          (click)="setActiveTab('upcoming')">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M8 2v4"/>
            <path d="M16 2v4"/>
            <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/>
            <path d="M3 10h18"/>
          </svg>
          Upcoming ({{ upcomingAppointments.length }})
        </button>
        <button 
          class="tab-button" 
          [class.active]="activeTab === 'past'"
          (click)="setActiveTab('past')">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M9 11l3 3 8-8"/>
            <path d="M21 12c0 4.97-4.03 9-9 9s-9-4.03-9-9 4.03-9 9-9c1.5 0 2.9.37 4.13 1.02"/>
          </svg>
          Past ({{ pastAppointments.length }})
        </button>
      </div>
    </div>

    <!-- Appointments List -->
    <div class="appointments-list">
      <div *ngIf="getCurrentAppointments().length === 0" class="no-appointments">
        <div class="no-appointments-content">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M8 2v4"/>
            <path d="M16 2v4"/>
            <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/>
            <path d="M3 10h18"/>
          </svg>
          <h3>No {{ activeTab }} appointments</h3>
          <p *ngIf="activeTab === 'upcoming'">
            You don't have any upcoming appointments. 
            <a (click)="router.navigate(['/schedule-appointment'])" class="link">Schedule one now</a>
          </p>
          <p *ngIf="activeTab === 'past'">
            You don't have any past appointments yet.
          </p>
        </div>
      </div>

      <div *ngFor="let appointment of getCurrentAppointments()" class="appointment-card">
        <div class="appointment-header">
          <div class="appointment-info">
            <h3 class="doctor-name">{{ appointment.doctor.user.name }}</h3>
            <p class="specialization">{{ appointment.doctor.specialization.name }}</p>
            <div class="appointment-meta">
              <span class="appointment-type" [ngClass]="getAppointmentTypeClass(appointment.appointmentType)">
                {{ appointment.appointmentType.replace('_', ' ') }}
              </span>
              <span class="appointment-fee">${{ appointment.consultationFee }}</span>
            </div>
          </div>
          <div class="appointment-status">
            <span class="badge" [ngClass]="getStatusBadgeClass(appointment.status)">
              {{ appointment.status }}
            </span>
          </div>
        </div>

        <div class="appointment-details">
          <div class="detail-row">
            <div class="detail-item">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M8 2v4"/>
                <path d="M16 2v4"/>
                <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/>
                <path d="M3 10h18"/>
              </svg>
              <span class="detail-label">Date:</span>
              <span class="detail-value">{{ formatDate(appointment.appointmentDate) }}</span>
            </div>
            <div class="detail-item">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="12" cy="12" r="10"/>
                <polyline points="12,6 12,12 16,14"/>
              </svg>
              <span class="detail-label">Time:</span>
              <span class="detail-value">{{ formatTime(appointment.appointmentTime) }} - {{ formatTime(appointment.endTime) }}</span>
            </div>
          </div>

          <div *ngIf="appointment.symptoms" class="symptoms-section">
            <h4 class="section-title">Symptoms</h4>
            <p class="symptoms-text">{{ appointment.symptoms }}</p>
          </div>

          <div *ngIf="appointment.notes" class="notes-section">
            <h4 class="section-title">Notes</h4>
            <p class="notes-text">{{ appointment.notes }}</p>
          </div>
        </div>

        <div class="appointment-actions" *ngIf="activeTab === 'upcoming'">
          <button 
            *ngIf="canRescheduleAppointment(appointment)"
            class="btn btn-secondary"
            (click)="rescheduleAppointment(appointment)">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"/>
              <path d="M21 3v5h-5"/>
              <path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"/>
              <path d="M3 21v-5h5"/>
            </svg>
            Reschedule
          </button>
          <button 
            *ngIf="canCancelAppointment(appointment)"
            class="btn btn-danger"
            (click)="cancelAppointment(appointment)">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M18 6L6 18"/>
              <path d="M6 6l12 12"/>
            </svg>
            Cancel
          </button>
        </div>
      </div>
    </div>
  </div>
</div>
